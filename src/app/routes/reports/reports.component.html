<page-header></page-header>

<form [formGroup]="reportForm">
  <div fxLayout="row wrap" class="matero-row">
    <div fxFlex="50" fxFlex.lt-sm="100">
      <div fxFlex="50" fxFlex.lt-sm="100">
        <mat-form-field>
          <mat-select formControlName="story" placeholder="Cửa hàng">
            <mat-option *ngFor="let item of listStories" [value]="item.id">
              {{ item.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="50" fxFlex.lt-sm="100">
        <mat-form-field>
          <mat-select formControlName="category" placeholder="Danh mục">
            <mat-option>--Tất cả--</mat-option>
            <mat-option *ngFor="let item of listCategory" [value]="item.id">
              {{ item.categoryName }}</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
  <div fxLayout="row wrap" class="matero-row">
    <div fxFlex="50" fxFlex.lt-sm="100">
      <div fxFlex="50" fxFlex.lt-sm="100">
        <mat-form-field>
          <input
            matInput
            [matDatepicker]="startPicker"
            placeholder="Từ ngày"
            formControlName="dateFrom"
          />
          <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
          <mat-datepicker #startPicker></mat-datepicker>
        </mat-form-field>
      </div>
      <div fxFlex="50" fxFlex.lt-sm="100">
        <mat-form-field>
          <input
            matInput
            [matDatepicker]="endPicker"
            placeholder="Đến ngày"
            formControlName="dateTo"
          />
          <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
          <mat-datepicker #endPicker></mat-datepicker>
        </mat-form-field>
      </div>
    </div>
  </div>
  <button
    mat-raised-button
    color="primary"
    class="m-t-8"
    style="margin-bottom: 1%"
    (click)="getReport()"
    [disabled]="reportForm.invalid"
  >
    Tìm kiếm
  </button>
  <button
    mat-raised-button
    color="primary"
    class="m-t-8"
    style="margin-bottom: 1%; margin-left: 1%"
    (click)="exportExcel()"
    [disabled]="reportForm.invalid"
  >
    Xuất excel
  </button>
</form>

<mat-card>
  <mat-card-title>Báo cáo doanh thu {{ storyName ? storyName : '' }}</mat-card-title>
  <mat-table
    aria-readonly="true"
    [dataSource]="listReport"
    aria-label="Users favorite colors and age"
  >
    <ng-container cdkColumnDef="productName">
      <mat-header-cell *cdkHeaderCellDef>Tên sản phẩm</mat-header-cell>
      <mat-cell *cdkCellDef="let row">{{ row.productName }}</mat-cell>
    </ng-container>
    <ng-container cdkColumnDef="unitPrice">
      <mat-header-cell *cdkHeaderCellDef>Giá sản phẩm</mat-header-cell>
      <mat-cell *cdkCellDef="let row">{{ row.unitPrice }}</mat-cell>
    </ng-container>
    <ng-container cdkColumnDef="inventoryQuantity">
      <mat-header-cell *cdkHeaderCellDef>Lượng tồn kho</mat-header-cell>
      <mat-cell *cdkCellDef="let row"
        >{{ row.inventoryQuantity ? row.inventoryQuantity : '' }}
      </mat-cell>
    </ng-container>
    <ng-container cdkColumnDef="discount">
      <mat-header-cell *cdkHeaderCellDef>Khuyến mại</mat-header-cell>
      <mat-cell *cdkCellDef="let row">{{ row.discount ? row.discount : '' }}</mat-cell>
    </ng-container>
    <ng-container cdkColumnDef="soldQuantity">
      <mat-header-cell *cdkHeaderCellDef>Số lượng đã bán</mat-header-cell>
      <mat-cell *cdkCellDef="let row">{{ row.soldQuantity ? row.soldQuantity : '' }}</mat-cell>
    </ng-container>
    <ng-container cdkColumnDef="revenue">
      <mat-header-cell *cdkHeaderCellDef>Doanh thu</mat-header-cell>
      <mat-cell *cdkCellDef="let row">{{ row.revenue ? row.revenue : '' }}</mat-cell>
    </ng-container>
    <mat-header-row *cdkHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *cdkRowDef="let row; columns: displayedColumns"></mat-row>
  </mat-table>
</mat-card>
